{
  "uid" : "7035d37d6991ecb6",
  "name" : "Record a vaccine with nhs number [10-9474335052-BECCLES HOUSE-Outreach event-yes-today-2-yes-yes-today-2-AMERY PIGGOTT-20/4/1968-10 CONNAUGHT ROAD, LANCASTER, LA1 4BQ-COVID-19-AUTOMATION-C10-19/10/2026]",
  "fullName" : "/app/features/record_a_vaccine_for_patient_with_nhs_number.feature:Record a vaccine with nhs number",
  "historyId" : "9376c8f476a292fa75224995de114147",
  "time" : {
    "start" : 1731678443092,
    "stop" : 1731678476675,
    "duration" : 33583
  },
  "status" : "failed",
  "statusMessage" : "TypeError: add_vaccine_type_batch() missing 1 required positional argument: 'expiry_date'",
  "statusTrace" : "fixturefunc = <function step_record_consent_and_click_continue_to_vaccinate_screen at 0x7f47aa14f380>\nrequest = <FixtureRequest for <Function test_record_a_vaccine_with_nhs_number[10-9474335052-BECCLES HOUSE-Outreach event-yes-today-2-yes-yes-today-2-AMERY PIGGOTT-20/4/1968-10 CONNAUGHT ROAD, LANCASTER, LA1 4BQ-COVID-19-AUTOMATION-C10-19/10/2026]>>\nkwargs = {'consent': 'yes', 'shared_data': {'assessment_comments': 'Assessment comments 13/11/2024AMERY PIGGOTT', 'batch_expiry_date': '19/10/2026', 'batch_number': 'AUTOMATION-C10', 'care_model': \"Housebound patient's home\", ...}}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -> FixtureValue:\n        if is_generator(fixturefunc):\n            fixturefunc = cast(\n                Callable[..., Generator[FixtureValue, None, None]], fixturefunc\n            )\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f\"{request.fixturename} did not yield a value\") from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n>           fixture_result = fixturefunc(**kwargs)\n\n.tox/py311/lib/python3.11/site-packages/_pytest/fixtures.py:898: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/test_record_a_vaccine_for_patient_with_nhs_number_steps.py:121: in step_record_consent_and_click_continue_to_vaccinate_screen\n    record_consent_details_and_click_continue_to_vaccinate(shared_data['consent_decision'],shared_data['consent_given_by'], name_of_person_consenting, relationship_to_patient, shared_data['consent_clinician_details'], shared_data['legal_mechanism'], shared_data[\"no_consent_reason\"])\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nconsent_decision = 'yes'\nconsent_given_by = \"Clinician following the Mental Capacity Act (in the patient's best interests)\"\nperson_consenting_name = 'Automation tester'\nrelationship_to_patient = 'RAVS tester'\nconsent_clinician = 'Automated Recorder - neelima.guntupalli1+recorder_automated@nhs.net'\nlegal_mechanism = 'Patient Specific Direction (PSD)'\nno_consent_reason = 'Personal Choice'\n\n    def record_consent_details_and_click_continue_to_vaccinate(consent_decision,  consent_given_by, person_consenting_name, relationship_to_patient,  consent_clinician, legal_mechanism, no_consent_reason=None):\n        attach_screenshot(\"before_selecting_consent_clinician\")\n    \n        logging.debug(\"Consent clinician to select is: \" + consent_clinician)\n        logging.debug(\"Consent legal mechanism is: \" + legal_mechanism)\n    \n        if (legal_mechanism) != \"Patient Group Direction (PGD)\":\n            select_consent_clinician_with_name_and_council(consent_clinician)\n            attach_screenshot(\"selected_consent_clinician_with_name_and_council\")\n    \n        if consent_decision.lower() == 'yes':\n            click_yes_to_consent()\n            attach_screenshot(\"clicked_yes_to_consent\")\n            select_consent_given_by_from_dropdown(consent_given_by)\n            attach_screenshot(\"selected_consent_given_by_from_dropdown\")\n    \n            if consent_given_by != \"Patient (informed consent)\":\n                enter_person_consenting_details(person_consenting_name)\n                attach_screenshot(\"entered_person_consenting_details\")\n                enter_relationship_to_patient(relationship_to_patient)\n>               add_vaccine_type_batch(\"entered_relationship_to_patient\")\nE               TypeError: add_vaccine_type_batch() missing 1 required positional argument: 'expiry_date'\n\nconftest.py:347: TypeError",
  "flaky" : false,
  "newFailed" : false,
  "newBroken" : false,
  "newPassed" : false,
  "retriesCount" : 0,
  "retriesStatusChange" : false,
  "beforeStages" : [ ],
  "testStage" : {
    "status" : "failed",
    "statusMessage" : "TypeError: add_vaccine_type_batch() missing 1 required positional argument: 'expiry_date'",
    "statusTrace" : "fixturefunc = <function step_record_consent_and_click_continue_to_vaccinate_screen at 0x7f47aa14f380>\nrequest = <FixtureRequest for <Function test_record_a_vaccine_with_nhs_number[10-9474335052-BECCLES HOUSE-Outreach event-yes-today-2-yes-yes-today-2-AMERY PIGGOTT-20/4/1968-10 CONNAUGHT ROAD, LANCASTER, LA1 4BQ-COVID-19-AUTOMATION-C10-19/10/2026]>>\nkwargs = {'consent': 'yes', 'shared_data': {'assessment_comments': 'Assessment comments 13/11/2024AMERY PIGGOTT', 'batch_expiry_date': '19/10/2026', 'batch_number': 'AUTOMATION-C10', 'care_model': \"Housebound patient's home\", ...}}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -> FixtureValue:\n        if is_generator(fixturefunc):\n            fixturefunc = cast(\n                Callable[..., Generator[FixtureValue, None, None]], fixturefunc\n            )\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f\"{request.fixturename} did not yield a value\") from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n>           fixture_result = fixturefunc(**kwargs)\n\n.tox/py311/lib/python3.11/site-packages/_pytest/fixtures.py:898: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/test_record_a_vaccine_for_patient_with_nhs_number_steps.py:121: in step_record_consent_and_click_continue_to_vaccinate_screen\n    record_consent_details_and_click_continue_to_vaccinate(shared_data['consent_decision'],shared_data['consent_given_by'], name_of_person_consenting, relationship_to_patient, shared_data['consent_clinician_details'], shared_data['legal_mechanism'], shared_data[\"no_consent_reason\"])\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nconsent_decision = 'yes'\nconsent_given_by = \"Clinician following the Mental Capacity Act (in the patient's best interests)\"\nperson_consenting_name = 'Automation tester'\nrelationship_to_patient = 'RAVS tester'\nconsent_clinician = 'Automated Recorder - neelima.guntupalli1+recorder_automated@nhs.net'\nlegal_mechanism = 'Patient Specific Direction (PSD)'\nno_consent_reason = 'Personal Choice'\n\n    def record_consent_details_and_click_continue_to_vaccinate(consent_decision,  consent_given_by, person_consenting_name, relationship_to_patient,  consent_clinician, legal_mechanism, no_consent_reason=None):\n        attach_screenshot(\"before_selecting_consent_clinician\")\n    \n        logging.debug(\"Consent clinician to select is: \" + consent_clinician)\n        logging.debug(\"Consent legal mechanism is: \" + legal_mechanism)\n    \n        if (legal_mechanism) != \"Patient Group Direction (PGD)\":\n            select_consent_clinician_with_name_and_council(consent_clinician)\n            attach_screenshot(\"selected_consent_clinician_with_name_and_council\")\n    \n        if consent_decision.lower() == 'yes':\n            click_yes_to_consent()\n            attach_screenshot(\"clicked_yes_to_consent\")\n            select_consent_given_by_from_dropdown(consent_given_by)\n            attach_screenshot(\"selected_consent_given_by_from_dropdown\")\n    \n            if consent_given_by != \"Patient (informed consent)\":\n                enter_person_consenting_details(person_consenting_name)\n                attach_screenshot(\"entered_person_consenting_details\")\n                enter_relationship_to_patient(relationship_to_patient)\n>               add_vaccine_type_batch(\"entered_relationship_to_patient\")\nE               TypeError: add_vaccine_type_batch() missing 1 required positional argument: 'expiry_date'\n\nconftest.py:347: TypeError",
    "steps" : [ {
      "name" : "Given I login to RAVS and set vaccinator details with BECCLES HOUSE and Outreach event and get patient details for 9474335052 with option 10 and choose to vaccinate with vaccine details as COVID-19, AUTOMATION-C10 with 19/10/2026",
      "time" : {
        "start" : 1731678443092,
        "stop" : 1731678447408,
        "duration" : 4316
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "b34becfe578b170a",
        "name" : "qa_edge_131.0.2903.48_clicked_vaccines_nav_link.png",
        "source" : "b34becfe578b170a.png",
        "type" : "image/png",
        "size" : 46598
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 1,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I search for a patient with the NHS number in the find a patient screen",
      "time" : {
        "start" : 1731678447408,
        "stop" : 1731678453278,
        "duration" : 5870
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "bcf23b913d64fe8b",
        "name" : "qa_edge_131.0.2903.48_entered_nhs_number_as9474335052_and_clicked_search_for_patient_button.png",
        "source" : "bcf23b913d64fe8b.png",
        "type" : "image/png",
        "size" : 49112
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 1,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I open the patient record by clicking on patient AMERY PIGGOTT",
      "time" : {
        "start" : 1731678453279,
        "stop" : 1731678455600,
        "duration" : 2321
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "fdec4d8dad1853d3",
        "name" : "qa_edge_131.0.2903.48_before_clicking_patient_name.png",
        "source" : "fdec4d8dad1853d3.png",
        "type" : "image/png",
        "size" : 49112
      }, {
        "uid" : "8bd459493d26af73",
        "name" : "qa_edge_131.0.2903.48_before_clicking_patient_name.png",
        "source" : "8bd459493d26af73.png",
        "type" : "image/png",
        "size" : 55100
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 2,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "When I click choose vaccine button and choose the COVID-19, AUTOMATION-C10 with 19/10/2026 and click continue",
      "time" : {
        "start" : 1731678455601,
        "stop" : 1731678467016,
        "duration" : 11415
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "c1baf04a1f070e61",
        "name" : "qa_edge_131.0.2903.48_immunisation_history_records_count_is_1.png",
        "source" : "c1baf04a1f070e61.png",
        "type" : "image/png",
        "size" : 55100
      }, {
        "uid" : "769d10875914e3ca",
        "name" : "qa_edge_131.0.2903.48_clicked_choose_vaccine_button.png",
        "source" : "769d10875914e3ca.png",
        "type" : "image/png",
        "size" : 82357
      }, {
        "uid" : "6b420e86336f03a2",
        "name" : "qa_edge_131.0.2903.48_clicked_on_patient_AMERY PIGGOTT_and_clicked_choose_vaccine_button.png",
        "source" : "6b420e86336f03a2.png",
        "type" : "image/png",
        "size" : 82357
      }, {
        "uid" : "ecf33c2529c488c1",
        "name" : "qa_edge_131.0.2903.48_clicked_delivery_team.png",
        "source" : "ecf33c2529c488c1.png",
        "type" : "image/png",
        "size" : 83717
      }, {
        "uid" : "a91acfab4553b534",
        "name" : "qa_edge_131.0.2903.48_clicked_vaccine.png",
        "source" : "a91acfab4553b534.png",
        "type" : "image/png",
        "size" : 54905
      }, {
        "uid" : "b41c804ac5ce8a26",
        "name" : "qa_edge_131.0.2903.48_clicked_vaccine_type.png",
        "source" : "b41c804ac5ce8a26.png",
        "type" : "image/png",
        "size" : 55689
      }, {
        "uid" : "df5b3063b9ad9a3d",
        "name" : "qa_edge_131.0.2903.48_selected_vaccine_COVID-19_and_Comirnaty 10 JN.1_and_clicked_continue_button.png",
        "source" : "df5b3063b9ad9a3d.png",
        "type" : "image/png",
        "size" : 76443
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 7,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I assess the patient's yes with the details and date as today-2 and click continue to record consent screen button",
      "time" : {
        "start" : 1731678467016,
        "stop" : 1731678473282,
        "duration" : 6266
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "4ac54af462e4ce4e",
        "name" : "qa_edge_131.0.2903.48_clicked_eligible_yes_radiobutton.png",
        "source" : "4ac54af462e4ce4e.png",
        "type" : "image/png",
        "size" : 72465
      }, {
        "uid" : "c7a18ba40a2669e6",
        "name" : "qa_edge_131.0.2903.48_selected_eligibility_type.png",
        "source" : "c7a18ba40a2669e6.png",
        "type" : "image/png",
        "size" : 71976
      }, {
        "uid" : "c21483ce38b19a29",
        "name" : "qa_edge_131.0.2903.48_clicked_eligibility_yes_and_selected_eligibility_type.png",
        "source" : "c21483ce38b19a29.png",
        "type" : "image/png",
        "size" : 71976
      }, {
        "uid" : "67b1418e0c3a43a8",
        "name" : "qa_edge_131.0.2903.48_set_assessment_date.png",
        "source" : "67b1418e0c3a43a8.png",
        "type" : "image/png",
        "size" : 71703
      }, {
        "uid" : "15370748d2ce132",
        "name" : "qa_edge_131.0.2903.48_clicked_legal_mechanism.png",
        "source" : "15370748d2ce132.png",
        "type" : "image/png",
        "size" : 70561
      }, {
        "uid" : "dda314693631bdc2",
        "name" : "qa_edge_131.0.2903.48_selected_assessing_clinician_with_name_and_council.png",
        "source" : "dda314693631bdc2.png",
        "type" : "image/png",
        "size" : 72666
      }, {
        "uid" : "f5c74662e0af2103",
        "name" : "qa_edge_131.0.2903.48_clicked_patient_give_vaccine_radio_button.png",
        "source" : "f5c74662e0af2103.png",
        "type" : "image/png",
        "size" : 72931
      }, {
        "uid" : "57d9f7c0a051ba8f",
        "name" : "qa_edge_131.0.2903.48_entered_comments_for_assessing_patient.png",
        "source" : "57d9f7c0a051ba8f.png",
        "type" : "image/png",
        "size" : 73544
      }, {
        "uid" : "d1c022d8c6b460b",
        "name" : "qa_edge_131.0.2903.48_clicked_continue_to_record_consent_button.png",
        "source" : "d1c022d8c6b460b.png",
        "type" : "image/png",
        "size" : 43057
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 9,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I record yes with the details and click continue to vaccinate button",
      "time" : {
        "start" : 1731678473282,
        "stop" : 1731678476675,
        "duration" : 3393
      },
      "status" : "failed",
      "statusMessage" : "add_vaccine_type_batch() missing 1 required positional argument: 'expiry_date'",
      "statusTrace" : "TypeError: add_vaccine_type_batch() missing 1 required positional argument: 'expiry_date'\n",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "e58db928cf5d1961",
        "name" : "qa_edge_131.0.2903.48_before_selecting_consent_clinician.png",
        "source" : "e58db928cf5d1961.png",
        "type" : "image/png",
        "size" : 43057
      }, {
        "uid" : "957ec5197e13e08b",
        "name" : "qa_edge_131.0.2903.48_selected_consent_clinician_with_name_and_council.png",
        "source" : "957ec5197e13e08b.png",
        "type" : "image/png",
        "size" : 46024
      }, {
        "uid" : "1826dcbe8105dd03",
        "name" : "qa_edge_131.0.2903.48_clicked_yes_to_consent.png",
        "source" : "1826dcbe8105dd03.png",
        "type" : "image/png",
        "size" : 75319
      }, {
        "uid" : "60e4dab113f26a2f",
        "name" : "qa_edge_131.0.2903.48_selected_consent_given_by_from_dropdown.png",
        "source" : "60e4dab113f26a2f.png",
        "type" : "image/png",
        "size" : 78288
      }, {
        "uid" : "5b994924e76aa41d",
        "name" : "qa_edge_131.0.2903.48_entered_person_consenting_details.png",
        "source" : "5b994924e76aa41d.png",
        "type" : "image/png",
        "size" : 79568
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 5,
      "shouldDisplayMessage" : true,
      "hasContent" : true
    } ],
    "attachments" : [ {
      "uid" : "b07e2cea5761216c",
      "name" : "log",
      "source" : "b07e2cea5761216c.txt",
      "type" : "text/plain",
      "size" : 14449
    } ],
    "parameters" : [ ],
    "stepsCount" : 6,
    "attachmentsCount" : 26,
    "shouldDisplayMessage" : true,
    "hasContent" : true
  },
  "afterStages" : [ ],
  "labels" : [ {
    "name" : "host",
    "value" : "d663d667dee7"
  }, {
    "name" : "thread",
    "value" : "1099-MainThread"
  }, {
    "name" : "framework",
    "value" : "pytest-bdd"
  }, {
    "name" : "language",
    "value" : "cpython3"
  }, {
    "name" : "feature",
    "value" : "Record vaccine"
  }, {
    "name" : "resultFormat",
    "value" : "allure2"
  } ],
  "parameters" : [ {
    "name" : "address",
    "value" : "10 CONNAUGHT ROAD, LANCASTER, LA1 4BQ"
  }, {
    "name" : "assess_date",
    "value" : "today-2"
  }, {
    "name" : "batch_expiry_date",
    "value" : "19/10/2026"
  }, {
    "name" : "batch_number",
    "value" : "AUTOMATION-C10"
  }, {
    "name" : "care_model",
    "value" : "Outreach event"
  }, {
    "name" : "chosen_vaccine",
    "value" : "COVID-19"
  }, {
    "name" : "consent",
    "value" : "yes"
  }, {
    "name" : "dob",
    "value" : "20/4/1968"
  }, {
    "name" : "eligibility",
    "value" : "yes"
  }, {
    "name" : "index",
    "value" : "10"
  }, {
    "name" : "name",
    "value" : "AMERY PIGGOTT"
  }, {
    "name" : "nhs_number",
    "value" : "9474335052"
  }, {
    "name" : "site",
    "value" : "BECCLES HOUSE"
  }, {
    "name" : "vaccination",
    "value" : "yes"
  }, {
    "name" : "vaccination_date",
    "value" : "today-2"
  } ],
  "links" : [ ],
  "hidden" : false,
  "retry" : false,
  "extra" : {
    "severity" : "normal",
    "retries" : [ ],
    "categories" : [ {
      "name" : "Product defects",
      "matchedStatuses" : [ ],
      "flaky" : false
    } ],
    "tags" : [ ]
  },
  "source" : "7035d37d6991ecb6.json",
  "parameterValues" : [ "10 CONNAUGHT ROAD, LANCASTER, LA1 4BQ", "today-2", "19/10/2026", "AUTOMATION-C10", "Outreach event", "COVID-19", "yes", "20/4/1968", "yes", "10", "AMERY PIGGOTT", "9474335052", "BECCLES HOUSE", "yes", "today-2" ]
}