{
  "uid" : "4f0a4f0b117339b0",
  "name" : "Record a vaccine with nhs number [10-9474335052-BECCLES HOUSE-Outreach event-yes-today-2-yes-yes-today-2-AMERY PIGGOTT-20/4/1968-10 CONNAUGHT ROAD, LANCASTER, LA1 4BQ-COVID-19-SDYY2-18C-19/10/2026]",
  "fullName" : "/app/features/record_a_vaccine_for_patient_with_nhs_number.feature:Record a vaccine with nhs number",
  "historyId" : "a49a49d2d1dc567bcc3a2255ec5ec62b",
  "time" : {
    "start" : 1730914511896,
    "stop" : 1730914534913,
    "duration" : 23017
  },
  "status" : "failed",
  "statusMessage" : "AssertionError: assert 11 >= (11 + 1)\n +  where 11 = int(11)\n +  and   11 = int(11)",
  "statusTrace" : "fixturefunc = <function immunisation_history_should_be_updated at 0x7f78e8c5a0c0>\nrequest = <FixtureRequest for <Function test_record_a_vaccine_with_nhs_number[10-9474335052-BECCLES HOUSE-Outreach event-yes-today-2-yes-yes-today-2-AMERY PIGGOTT-20/4/1968-10 CONNAUGHT ROAD, LANCASTER, LA1 4BQ-COVID-19-SDYY2-18C-19/10/2026]>>\nkwargs = {'shared_data': {'assessment_comments': 'Assessment comments 04/11/2024AMERY PIGGOTT', 'batch_expiry_date': '19/10/2026', 'batch_number': 'SDYY2-18C', 'care_model': 'Hospital hub for staff and patients', ...}}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -> FixtureValue:\n        if is_generator(fixturefunc):\n            fixturefunc = cast(\n                Callable[..., Generator[FixtureValue, None, None]], fixturefunc\n            )\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f\"{request.fixturename} did not yield a value\") from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n>           fixture_result = fixturefunc(**kwargs)\n\n.tox/py311/lib/python3.11/site-packages/_pytest/fixtures.py:898: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nshared_data = {'assessment_comments': 'Assessment comments 04/11/2024AMERY PIGGOTT', 'batch_expiry_date': '19/10/2026', 'batch_number': 'SDYY2-18C', 'care_model': 'Hospital hub for staff and patients', ...}\n\n    @then(\"the immunisation history of the patient should be updated in the patient details page\")\n    def immunisation_history_should_be_updated(shared_data):\n        attach_screenshot(\"immunisation_history_records_count_after_vaccination\")\n        immunisation_history_records_count_after_vaccination = get_count_of_immunisation_history_records(shared_data[\"chosen_vaccine\"])\n>       assert int(immunisation_history_records_count_after_vaccination) >= int(shared_data[\"immunisation_history_records_count_before_vaccination\"]) + 1\nE       assert 11 >= (11 + 1)\nE        +  where 11 = int(11)\nE        +  and   11 = int(11)\n\ntests/test_record_a_vaccine_for_patient_with_nhs_number_steps.py:171: AssertionError",
  "flaky" : false,
  "newFailed" : false,
  "newBroken" : false,
  "newPassed" : false,
  "retriesCount" : 0,
  "retriesStatusChange" : false,
  "beforeStages" : [ ],
  "testStage" : {
    "status" : "failed",
    "statusMessage" : "AssertionError: assert 11 >= (11 + 1)\n +  where 11 = int(11)\n +  and   11 = int(11)",
    "statusTrace" : "fixturefunc = <function immunisation_history_should_be_updated at 0x7f78e8c5a0c0>\nrequest = <FixtureRequest for <Function test_record_a_vaccine_with_nhs_number[10-9474335052-BECCLES HOUSE-Outreach event-yes-today-2-yes-yes-today-2-AMERY PIGGOTT-20/4/1968-10 CONNAUGHT ROAD, LANCASTER, LA1 4BQ-COVID-19-SDYY2-18C-19/10/2026]>>\nkwargs = {'shared_data': {'assessment_comments': 'Assessment comments 04/11/2024AMERY PIGGOTT', 'batch_expiry_date': '19/10/2026', 'batch_number': 'SDYY2-18C', 'care_model': 'Hospital hub for staff and patients', ...}}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -> FixtureValue:\n        if is_generator(fixturefunc):\n            fixturefunc = cast(\n                Callable[..., Generator[FixtureValue, None, None]], fixturefunc\n            )\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f\"{request.fixturename} did not yield a value\") from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n>           fixture_result = fixturefunc(**kwargs)\n\n.tox/py311/lib/python3.11/site-packages/_pytest/fixtures.py:898: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nshared_data = {'assessment_comments': 'Assessment comments 04/11/2024AMERY PIGGOTT', 'batch_expiry_date': '19/10/2026', 'batch_number': 'SDYY2-18C', 'care_model': 'Hospital hub for staff and patients', ...}\n\n    @then(\"the immunisation history of the patient should be updated in the patient details page\")\n    def immunisation_history_should_be_updated(shared_data):\n        attach_screenshot(\"immunisation_history_records_count_after_vaccination\")\n        immunisation_history_records_count_after_vaccination = get_count_of_immunisation_history_records(shared_data[\"chosen_vaccine\"])\n>       assert int(immunisation_history_records_count_after_vaccination) >= int(shared_data[\"immunisation_history_records_count_before_vaccination\"]) + 1\nE       assert 11 >= (11 + 1)\nE        +  where 11 = int(11)\nE        +  and   11 = int(11)\n\ntests/test_record_a_vaccine_for_patient_with_nhs_number_steps.py:171: AssertionError",
    "steps" : [ {
      "name" : "Given I login to RAVS and set vaccinator details with BECCLES HOUSE and Outreach event and get patient details for 9474335052 with option 10 and choose to vaccinate with vaccine details as COVID-19, SDYY2-18C with 19/10/2026",
      "time" : {
        "start" : 1730914511897,
        "stop" : 1730914512704,
        "duration" : 807
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 0,
      "shouldDisplayMessage" : false,
      "hasContent" : false
    }, {
      "name" : "And I search for a patient with the NHS number in the find a patient screen",
      "time" : {
        "start" : 1730914512704,
        "stop" : 1730914513098,
        "duration" : 394
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "4170b8906a46f56c",
        "name" : "dev_edge_130.0.2849.68_entered_nhs_number_as9474335052_and_clicked_search_for_patient_button.png",
        "source" : "4170b8906a46f56c.png",
        "type" : "image/png",
        "size" : 48924
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 1,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I open the patient record by clicking on patient AMERY PIGGOTT",
      "time" : {
        "start" : 1730914513098,
        "stop" : 1730914514892,
        "duration" : 1794
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "34b218c2f93d7f3c",
        "name" : "dev_edge_130.0.2849.68_before_clicking_patient_name.png",
        "source" : "34b218c2f93d7f3c.png",
        "type" : "image/png",
        "size" : 48987
      }, {
        "uid" : "4e61e7b87888f483",
        "name" : "dev_edge_130.0.2849.68_before_clicking_patient_name.png",
        "source" : "4e61e7b87888f483.png",
        "type" : "image/png",
        "size" : 55112
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 2,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "When I click choose vaccine button and choose the COVID-19, SDYY2-18C with 19/10/2026 and click continue",
      "time" : {
        "start" : 1730914514892,
        "stop" : 1730914521310,
        "duration" : 6418
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "60f04577e50350dd",
        "name" : "dev_edge_130.0.2849.68_clicked_on_patient_AMERY PIGGOTT_and_clicked_choose_vaccine_button.png",
        "source" : "60f04577e50350dd.png",
        "type" : "image/png",
        "size" : 81961
      }, {
        "uid" : "9b9844521f20b9f2",
        "name" : "dev_edge_130.0.2849.68_selected_vaccine_COVID-19_and_Comirnaty 3 JN.1_and_clicked_continue_button.png",
        "source" : "9b9844521f20b9f2.png",
        "type" : "image/png",
        "size" : 75119
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 2,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I assess the patient's yes with the details and date as today-2 and click continue to record consent screen button",
      "time" : {
        "start" : 1730914521310,
        "stop" : 1730914522363,
        "duration" : 1053
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "ee7a35a54c377d80",
        "name" : "dev_edge_130.0.2849.68_clicked_eligibility_yes_and_selected_eligibility_type.png",
        "source" : "ee7a35a54c377d80.png",
        "type" : "image/png",
        "size" : 71936
      }, {
        "uid" : "712e0e01d973538f",
        "name" : "dev_edge_130.0.2849.68_clicked_patient_give_vaccine_radio_button.png",
        "source" : "712e0e01d973538f.png",
        "type" : "image/png",
        "size" : 45395
      }, {
        "uid" : "efa125e354243170",
        "name" : "dev_edge_130.0.2849.68_clicked_continue_to_record_consent_button.png",
        "source" : "efa125e354243170.png",
        "type" : "image/png",
        "size" : 43057
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 3,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I record yes with the details and click continue to vaccinate button",
      "time" : {
        "start" : 1730914522364,
        "stop" : 1730914524042,
        "duration" : 1678
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "66a4ccb3ba099cf5",
        "name" : "dev_edge_130.0.2849.68_before_selecting_consent_clinician.png",
        "source" : "66a4ccb3ba099cf5.png",
        "type" : "image/png",
        "size" : 43057
      }, {
        "uid" : "5a9fbc1f1cb2780d",
        "name" : "dev_edge_130.0.2849.68_clicked_continue_to_vaccinate_button.png",
        "source" : "5a9fbc1f1cb2780d.png",
        "type" : "image/png",
        "size" : 59004
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 2,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I record yes details and date as today-2 and click Continue to Check and confirm screen",
      "time" : {
        "start" : 1730914524042,
        "stop" : 1730914528526,
        "duration" : 4484
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "f0c2a00516b11401",
        "name" : "dev_edge_130.0.2849.68_entered_vaccination_details.png",
        "source" : "f0c2a00516b11401.png",
        "type" : "image/png",
        "size" : 52198
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 1,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "Then I need to be able to see the patient AMERY PIGGOTT, 20/4/1968, 10 CONNAUGHT ROAD, LANCASTER, LA1 4BQ and vaccination details on the check and confirm screen",
      "time" : {
        "start" : 1730914528526,
        "stop" : 1730914529329,
        "duration" : 803
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "28d12f0efa15f650",
        "name" : "dev_edge_130.0.2849.68_check_and_confirm_screen_before_assertion.png",
        "source" : "28d12f0efa15f650.png",
        "type" : "image/png",
        "size" : 52221
      }, {
        "uid" : "7dde3627475ef74a",
        "name" : "dev_edge_130.0.2849.68_vaccination_dose_amount.png",
        "source" : "7dde3627475ef74a.png",
        "type" : "image/png",
        "size" : 52221
      }, {
        "uid" : "6c1e3fd801bdfeea",
        "name" : "dev_edge_130.0.2849.68_check_and_confirm_screen_after_assertion.png",
        "source" : "6c1e3fd801bdfeea.png",
        "type" : "image/png",
        "size" : 52221
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 3,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And when I click confirm and save button, I should see a record saved dialogue",
      "time" : {
        "start" : 1730914529330,
        "stop" : 1730914530130,
        "duration" : 800
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "52e4436acc738331",
        "name" : "dev_edge_130.0.2849.68_patient_details_screen_with_immunisation_history.png",
        "source" : "52e4436acc738331.png",
        "type" : "image/png",
        "size" : 52221
      }, {
        "uid" : "85982a5ae60775d8",
        "name" : "dev_edge_130.0.2849.68_before_assert_record_saved.png",
        "source" : "85982a5ae60775d8.png",
        "type" : "image/png",
        "size" : 34843
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 2,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I search for a patient with the NHS number in the find a patient screen",
      "time" : {
        "start" : 1730914530130,
        "stop" : 1730914530474,
        "duration" : 344
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "9c0e4eefab4ca604",
        "name" : "dev_edge_130.0.2849.68_entered_nhs_number_as9474335052_and_clicked_search_for_patient_button.png",
        "source" : "9c0e4eefab4ca604.png",
        "type" : "image/png",
        "size" : 37935
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 1,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I open the patient record by clicking on patient AMERY PIGGOTT",
      "time" : {
        "start" : 1730914530474,
        "stop" : 1730914532754,
        "duration" : 2280
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "76c58ff14dfdea0",
        "name" : "dev_edge_130.0.2849.68_before_clicking_patient_name.png",
        "source" : "76c58ff14dfdea0.png",
        "type" : "image/png",
        "size" : 37988
      }, {
        "uid" : "490a4b5ed67e6a6c",
        "name" : "dev_edge_130.0.2849.68_before_clicking_patient_name.png",
        "source" : "490a4b5ed67e6a6c.png",
        "type" : "image/png",
        "size" : 55112
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 2,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And the immunisation history of the patient should be updated in the patient details page",
      "time" : {
        "start" : 1730914532755,
        "stop" : 1730914534913,
        "duration" : 2158
      },
      "status" : "failed",
      "statusMessage" : "assert 11 >= (11 + 1)\n +  where 11 = int(11)\n +  and   11 = int(11)",
      "statusTrace" : "AssertionError: assert 11 >= (11 + 1)\n +  where 11 = int(11)\n +  and   11 = int(11)\n",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "ec40f2e38bcd79c1",
        "name" : "dev_edge_130.0.2849.68_immunisation_history_records_count_after_vaccination.png",
        "source" : "ec40f2e38bcd79c1.png",
        "type" : "image/png",
        "size" : 55112
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 1,
      "shouldDisplayMessage" : true,
      "hasContent" : true
    } ],
    "attachments" : [ {
      "uid" : "577868114c83c1c4",
      "name" : "log",
      "source" : "577868114c83c1c4.txt",
      "type" : "text/plain",
      "size" : 14316
    } ],
    "parameters" : [ ],
    "stepsCount" : 12,
    "attachmentsCount" : 21,
    "shouldDisplayMessage" : true,
    "hasContent" : true
  },
  "afterStages" : [ ],
  "labels" : [ {
    "name" : "host",
    "value" : "bf990d2eaa46"
  }, {
    "name" : "thread",
    "value" : "1097-MainThread"
  }, {
    "name" : "framework",
    "value" : "pytest-bdd"
  }, {
    "name" : "language",
    "value" : "cpython3"
  }, {
    "name" : "feature",
    "value" : "Record vaccine"
  }, {
    "name" : "resultFormat",
    "value" : "allure2"
  } ],
  "parameters" : [ {
    "name" : "address",
    "value" : "10 CONNAUGHT ROAD, LANCASTER, LA1 4BQ"
  }, {
    "name" : "assess_date",
    "value" : "today-2"
  }, {
    "name" : "batch_expiry_date",
    "value" : "19/10/2026"
  }, {
    "name" : "batch_number",
    "value" : "SDYY2-18C"
  }, {
    "name" : "care_model",
    "value" : "Outreach event"
  }, {
    "name" : "chosen_vaccine",
    "value" : "COVID-19"
  }, {
    "name" : "consent",
    "value" : "yes"
  }, {
    "name" : "dob",
    "value" : "20/4/1968"
  }, {
    "name" : "eligibility",
    "value" : "yes"
  }, {
    "name" : "index",
    "value" : "10"
  }, {
    "name" : "name",
    "value" : "AMERY PIGGOTT"
  }, {
    "name" : "nhs_number",
    "value" : "9474335052"
  }, {
    "name" : "site",
    "value" : "BECCLES HOUSE"
  }, {
    "name" : "vaccination",
    "value" : "yes"
  }, {
    "name" : "vaccination_date",
    "value" : "today-2"
  } ],
  "links" : [ ],
  "hidden" : false,
  "retry" : false,
  "extra" : {
    "severity" : "normal",
    "retries" : [ ],
    "categories" : [ {
      "name" : "Product defects",
      "matchedStatuses" : [ ],
      "flaky" : false
    } ],
    "tags" : [ ]
  },
  "source" : "4f0a4f0b117339b0.json",
  "parameterValues" : [ "10 CONNAUGHT ROAD, LANCASTER, LA1 4BQ", "today-2", "19/10/2026", "SDYY2-18C", "Outreach event", "COVID-19", "yes", "20/4/1968", "yes", "10", "AMERY PIGGOTT", "9474335052", "BECCLES HOUSE", "yes", "today-2" ]
}