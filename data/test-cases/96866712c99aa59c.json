{
  "uid" : "96866712c99aa59c",
  "name" : "Record a vaccine with nhs number [11-9450134391-BECCLES HOUSE-Vaccination Centre-yes-today-3-yes-yes-today-MARIAN PIESSE-17/7/1994-2 BIRCH STREET, LYTHAM ST. ANNES, LANCS, FY8 5DT-Flu-SDYY2-14C-19/10/2026]",
  "fullName" : "/app/features/record_a_vaccine_for_patient_with_nhs_number.feature:Record a vaccine with nhs number",
  "historyId" : "8c38b547f0a063f1c3e7ed09f57cb417",
  "time" : {
    "start" : 1729541027343,
    "stop" : 1729541029330,
    "duration" : 1987
  },
  "status" : "failed",
  "statusMessage" : "Failed: An error occurred: Locator.is_visible: Error: strict mode violation: get_by_label(\"Quadrivalent Influenza Vaccine\") resolved to 4 elements:\n    1) <input value=\"7\" type=\"radio\" id=\"VaccineId7\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Quadrivalent Influenza Vaccine\", exact=True)\n    2) <input value=\"12\" type=\"radio\" id=\"VaccineId12\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Cell-based Quadrivalent\")\n    3) <input value=\"13\" type=\"radio\" id=\"VaccineId13\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Adjuvanted Quadrivalent\")\n    4) <input value=\"25\" type=\"radio\" id=\"VaccineId25\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Quadrivalent Influenza Vaccine – High Dose\")\n\nCall log:\n  checking visibility of get_by_label(\"Quadrivalent Influenza Vaccine\")",
  "statusTrace" : "element = <Locator frame=<Frame name= url='https://www.ravs-dev.england.nhs.uk/vaccines/add/choose-vaccine'> selector='internal:label=\"Quadrivalent Influenza Vaccine\"i'>\nwait = True\n\n    def check_element_exists(element, wait=False):\n        if isinstance(element, (tuple, list)):\n            element = get_element_by_type(*element)\n        elif isinstance(element, str):\n            element = get_element_by_type(element)\n        try:\n>           return playwright_helper_instance.check_element_exists(element, wait)\n\ninit_helpers.py:155: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nhelpers/playwrightHelper.py:168: in check_element_exists\n    is_visible = element.is_visible()\n.tox/py311/lib/python3.11/site-packages/playwright/sync_api/_generated.py:17017: in is_visible\n    self._sync(self._impl_obj.is_visible(timeout=timeout))\n.tox/py311/lib/python3.11/site-packages/playwright/_impl/_locator.py:500: in is_visible\n    return await self._frame.is_visible(\n.tox/py311/lib/python3.11/site-packages/playwright/_impl/_frame.py:354: in is_visible\n    return await self._channel.send(\"isVisible\", locals_to_params(locals()))\n.tox/py311/lib/python3.11/site-packages/playwright/_impl/_connection.py:59: in send\n    return await self._connection.wrap_api_call(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <playwright._impl._connection.Connection object at 0x7fdfec452e50>\ncb = <function Channel.send.<locals>.<lambda> at 0x7fdfe6827240>\nis_internal = False\n\n    async def wrap_api_call(\n        self, cb: Callable[[], Any], is_internal: bool = False\n    ) -> Any:\n        if self._api_zone.get():\n            return await cb()\n        task = asyncio.current_task(self._loop)\n        st: List[inspect.FrameInfo] = getattr(task, \"__pw_stack__\", inspect.stack())\n        parsed_st = _extract_stack_trace_information_from_stack(st, is_internal)\n        self._api_zone.set(parsed_st)\n        try:\n            return await cb()\n        except Exception as error:\n>           raise rewrite_error(error, f\"{parsed_st['apiName']}: {error}\") from None\nE           playwright._impl._errors.Error: Locator.is_visible: Error: strict mode violation: get_by_label(\"Quadrivalent Influenza Vaccine\") resolved to 4 elements:\nE               1) <input value=\"7\" type=\"radio\" id=\"VaccineId7\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Quadrivalent Influenza Vaccine\", exact=True)\nE               2) <input value=\"12\" type=\"radio\" id=\"VaccineId12\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Cell-based Quadrivalent\")\nE               3) <input value=\"13\" type=\"radio\" id=\"VaccineId13\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Adjuvanted Quadrivalent\")\nE               4) <input value=\"25\" type=\"radio\" id=\"VaccineId25\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Quadrivalent Influenza Vaccine – High Dose\")\nE           \nE           Call log:\nE             checking visibility of get_by_label(\"Quadrivalent Influenza Vaccine\")\n\n.tox/py311/lib/python3.11/site-packages/playwright/_impl/_connection.py:520: Error\n\nDuring handling of the above exception, another exception occurred:\n\nfixturefunc = <function step_login_to_ravs at 0x7fdfec3a8ea0>\nrequest = <FixtureRequest for <Function test_record_a_vaccine_with_nhs_number[11-9450134391-BECCLES HOUSE-Vaccination Centre-yes...ay-3-yes-yes-today-MARIAN PIESSE-17/7/1994-2 BIRCH STREET, LYTHAM ST. ANNES, LANCS, FY8 5DT-Flu-SDYY2-14C-19/10/2026]>>\nkwargs = {'batch_expiry_date': '19/10/2026', 'batch_number': 'SDYY2-14C', 'care_model': 'Vaccination Centre', 'chosen_vaccine': 'Flu', ...}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -> FixtureValue:\n        if is_generator(fixturefunc):\n            fixturefunc = cast(\n                Callable[..., Generator[FixtureValue, None, None]], fixturefunc\n            )\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f\"{request.fixturename} did not yield a value\") from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n>           fixture_result = fixturefunc(**kwargs)\n\n.tox/py311/lib/python3.11/site-packages/_pytest/fixtures.py:898: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/test_record_a_vaccine_for_patient_with_nhs_number_steps.py:56: in step_login_to_ravs\n    check_vaccine_and_batch_exists_in_site(site, chosen_vaccine, shared_data[\"chosen_vaccine_type\"], batch_number, batch_expiry_date)\nconftest.py:225: in check_vaccine_and_batch_exists_in_site\n    check_site_vaccine_type_has_active_batch(site, vaccine, vaccine_type, batch_number, expiry_date)\nconftest.py:232: in check_site_vaccine_type_has_active_batch\n    add_site_vaccine(site, vaccine, vaccine_type, batch_number, expiry_date)\nconftest.py:266: in add_site_vaccine\n    click_vaccine_type_radiobutton(vaccine_type)\npages/choose_vaccines_page.py:31: in click_vaccine_type_radiobutton\n    if check_element_exists(element, True) == True:\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nelement = <Locator frame=<Frame name= url='https://www.ravs-dev.england.nhs.uk/vaccines/add/choose-vaccine'> selector='internal:label=\"Quadrivalent Influenza Vaccine\"i'>\nwait = True\n\n    def check_element_exists(element, wait=False):\n        if isinstance(element, (tuple, list)):\n            element = get_element_by_type(*element)\n        elif isinstance(element, str):\n            element = get_element_by_type(element)\n        try:\n            return playwright_helper_instance.check_element_exists(element, wait)\n        except Exception as e:\n>           pytest.fail(f\"An error occurred: {e}\")\nE           Failed: An error occurred: Locator.is_visible: Error: strict mode violation: get_by_label(\"Quadrivalent Influenza Vaccine\") resolved to 4 elements:\nE               1) <input value=\"7\" type=\"radio\" id=\"VaccineId7\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Quadrivalent Influenza Vaccine\", exact=True)\nE               2) <input value=\"12\" type=\"radio\" id=\"VaccineId12\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Cell-based Quadrivalent\")\nE               3) <input value=\"13\" type=\"radio\" id=\"VaccineId13\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Adjuvanted Quadrivalent\")\nE               4) <input value=\"25\" type=\"radio\" id=\"VaccineId25\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Quadrivalent Influenza Vaccine – High Dose\")\nE           \nE           Call log:\nE             checking visibility of get_by_label(\"Quadrivalent Influenza Vaccine\")\n\ninit_helpers.py:157: Failed",
  "flaky" : false,
  "newFailed" : false,
  "newBroken" : false,
  "newPassed" : false,
  "retriesCount" : 0,
  "retriesStatusChange" : false,
  "beforeStages" : [ ],
  "testStage" : {
    "status" : "failed",
    "statusMessage" : "Failed: An error occurred: Locator.is_visible: Error: strict mode violation: get_by_label(\"Quadrivalent Influenza Vaccine\") resolved to 4 elements:\n    1) <input value=\"7\" type=\"radio\" id=\"VaccineId7\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Quadrivalent Influenza Vaccine\", exact=True)\n    2) <input value=\"12\" type=\"radio\" id=\"VaccineId12\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Cell-based Quadrivalent\")\n    3) <input value=\"13\" type=\"radio\" id=\"VaccineId13\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Adjuvanted Quadrivalent\")\n    4) <input value=\"25\" type=\"radio\" id=\"VaccineId25\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Quadrivalent Influenza Vaccine – High Dose\")\n\nCall log:\n  checking visibility of get_by_label(\"Quadrivalent Influenza Vaccine\")",
    "statusTrace" : "element = <Locator frame=<Frame name= url='https://www.ravs-dev.england.nhs.uk/vaccines/add/choose-vaccine'> selector='internal:label=\"Quadrivalent Influenza Vaccine\"i'>\nwait = True\n\n    def check_element_exists(element, wait=False):\n        if isinstance(element, (tuple, list)):\n            element = get_element_by_type(*element)\n        elif isinstance(element, str):\n            element = get_element_by_type(element)\n        try:\n>           return playwright_helper_instance.check_element_exists(element, wait)\n\ninit_helpers.py:155: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nhelpers/playwrightHelper.py:168: in check_element_exists\n    is_visible = element.is_visible()\n.tox/py311/lib/python3.11/site-packages/playwright/sync_api/_generated.py:17017: in is_visible\n    self._sync(self._impl_obj.is_visible(timeout=timeout))\n.tox/py311/lib/python3.11/site-packages/playwright/_impl/_locator.py:500: in is_visible\n    return await self._frame.is_visible(\n.tox/py311/lib/python3.11/site-packages/playwright/_impl/_frame.py:354: in is_visible\n    return await self._channel.send(\"isVisible\", locals_to_params(locals()))\n.tox/py311/lib/python3.11/site-packages/playwright/_impl/_connection.py:59: in send\n    return await self._connection.wrap_api_call(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <playwright._impl._connection.Connection object at 0x7fdfec452e50>\ncb = <function Channel.send.<locals>.<lambda> at 0x7fdfe6827240>\nis_internal = False\n\n    async def wrap_api_call(\n        self, cb: Callable[[], Any], is_internal: bool = False\n    ) -> Any:\n        if self._api_zone.get():\n            return await cb()\n        task = asyncio.current_task(self._loop)\n        st: List[inspect.FrameInfo] = getattr(task, \"__pw_stack__\", inspect.stack())\n        parsed_st = _extract_stack_trace_information_from_stack(st, is_internal)\n        self._api_zone.set(parsed_st)\n        try:\n            return await cb()\n        except Exception as error:\n>           raise rewrite_error(error, f\"{parsed_st['apiName']}: {error}\") from None\nE           playwright._impl._errors.Error: Locator.is_visible: Error: strict mode violation: get_by_label(\"Quadrivalent Influenza Vaccine\") resolved to 4 elements:\nE               1) <input value=\"7\" type=\"radio\" id=\"VaccineId7\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Quadrivalent Influenza Vaccine\", exact=True)\nE               2) <input value=\"12\" type=\"radio\" id=\"VaccineId12\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Cell-based Quadrivalent\")\nE               3) <input value=\"13\" type=\"radio\" id=\"VaccineId13\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Adjuvanted Quadrivalent\")\nE               4) <input value=\"25\" type=\"radio\" id=\"VaccineId25\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Quadrivalent Influenza Vaccine – High Dose\")\nE           \nE           Call log:\nE             checking visibility of get_by_label(\"Quadrivalent Influenza Vaccine\")\n\n.tox/py311/lib/python3.11/site-packages/playwright/_impl/_connection.py:520: Error\n\nDuring handling of the above exception, another exception occurred:\n\nfixturefunc = <function step_login_to_ravs at 0x7fdfec3a8ea0>\nrequest = <FixtureRequest for <Function test_record_a_vaccine_with_nhs_number[11-9450134391-BECCLES HOUSE-Vaccination Centre-yes...ay-3-yes-yes-today-MARIAN PIESSE-17/7/1994-2 BIRCH STREET, LYTHAM ST. ANNES, LANCS, FY8 5DT-Flu-SDYY2-14C-19/10/2026]>>\nkwargs = {'batch_expiry_date': '19/10/2026', 'batch_number': 'SDYY2-14C', 'care_model': 'Vaccination Centre', 'chosen_vaccine': 'Flu', ...}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -> FixtureValue:\n        if is_generator(fixturefunc):\n            fixturefunc = cast(\n                Callable[..., Generator[FixtureValue, None, None]], fixturefunc\n            )\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f\"{request.fixturename} did not yield a value\") from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n>           fixture_result = fixturefunc(**kwargs)\n\n.tox/py311/lib/python3.11/site-packages/_pytest/fixtures.py:898: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/test_record_a_vaccine_for_patient_with_nhs_number_steps.py:56: in step_login_to_ravs\n    check_vaccine_and_batch_exists_in_site(site, chosen_vaccine, shared_data[\"chosen_vaccine_type\"], batch_number, batch_expiry_date)\nconftest.py:225: in check_vaccine_and_batch_exists_in_site\n    check_site_vaccine_type_has_active_batch(site, vaccine, vaccine_type, batch_number, expiry_date)\nconftest.py:232: in check_site_vaccine_type_has_active_batch\n    add_site_vaccine(site, vaccine, vaccine_type, batch_number, expiry_date)\nconftest.py:266: in add_site_vaccine\n    click_vaccine_type_radiobutton(vaccine_type)\npages/choose_vaccines_page.py:31: in click_vaccine_type_radiobutton\n    if check_element_exists(element, True) == True:\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nelement = <Locator frame=<Frame name= url='https://www.ravs-dev.england.nhs.uk/vaccines/add/choose-vaccine'> selector='internal:label=\"Quadrivalent Influenza Vaccine\"i'>\nwait = True\n\n    def check_element_exists(element, wait=False):\n        if isinstance(element, (tuple, list)):\n            element = get_element_by_type(*element)\n        elif isinstance(element, str):\n            element = get_element_by_type(element)\n        try:\n            return playwright_helper_instance.check_element_exists(element, wait)\n        except Exception as e:\n>           pytest.fail(f\"An error occurred: {e}\")\nE           Failed: An error occurred: Locator.is_visible: Error: strict mode violation: get_by_label(\"Quadrivalent Influenza Vaccine\") resolved to 4 elements:\nE               1) <input value=\"7\" type=\"radio\" id=\"VaccineId7\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Quadrivalent Influenza Vaccine\", exact=True)\nE               2) <input value=\"12\" type=\"radio\" id=\"VaccineId12\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Cell-based Quadrivalent\")\nE               3) <input value=\"13\" type=\"radio\" id=\"VaccineId13\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Adjuvanted Quadrivalent\")\nE               4) <input value=\"25\" type=\"radio\" id=\"VaccineId25\" name=\"VaccineId\" class=\"nhsuk-radios__input\"/> aka get_by_label(\"Quadrivalent Influenza Vaccine – High Dose\")\nE           \nE           Call log:\nE             checking visibility of get_by_label(\"Quadrivalent Influenza Vaccine\")\n\ninit_helpers.py:157: Failed",
    "steps" : [ {
      "name" : "Given I login to RAVS and set vaccinator details with BECCLES HOUSE and Vaccination Centre and get patient details for 9450134391 with option 11 and choose to vaccinate with vaccine details as Flu, SDYY2-14C with 19/10/2026",
      "time" : {
        "start" : 1729541027344,
        "stop" : 1729541029510,
        "duration" : 2166
      },
      "status" : "skipped",
      "steps" : [ ],
      "attachments" : [ ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 0,
      "shouldDisplayMessage" : false,
      "hasContent" : false
    } ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 1,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : true,
    "hasContent" : true
  },
  "afterStages" : [ ],
  "labels" : [ {
    "name" : "host",
    "value" : "53d063788252"
  }, {
    "name" : "thread",
    "value" : "1100-MainThread"
  }, {
    "name" : "framework",
    "value" : "pytest-bdd"
  }, {
    "name" : "language",
    "value" : "cpython3"
  }, {
    "name" : "feature",
    "value" : "Record vaccine"
  }, {
    "name" : "resultFormat",
    "value" : "allure2"
  } ],
  "parameters" : [ {
    "name" : "address",
    "value" : "2 BIRCH STREET, LYTHAM ST. ANNES, LANCS, FY8 5DT"
  }, {
    "name" : "assess_date",
    "value" : "today-3"
  }, {
    "name" : "batch_expiry_date",
    "value" : "19/10/2026"
  }, {
    "name" : "batch_number",
    "value" : "SDYY2-14C"
  }, {
    "name" : "care_model",
    "value" : "Vaccination Centre"
  }, {
    "name" : "chosen_vaccine",
    "value" : "Flu"
  }, {
    "name" : "consent",
    "value" : "yes"
  }, {
    "name" : "dob",
    "value" : "17/7/1994"
  }, {
    "name" : "eligibility",
    "value" : "yes"
  }, {
    "name" : "index",
    "value" : "11"
  }, {
    "name" : "name",
    "value" : "MARIAN PIESSE"
  }, {
    "name" : "nhs_number",
    "value" : "9450134391"
  }, {
    "name" : "site",
    "value" : "BECCLES HOUSE"
  }, {
    "name" : "vaccination",
    "value" : "yes"
  }, {
    "name" : "vaccination_date",
    "value" : "today"
  } ],
  "links" : [ ],
  "hidden" : false,
  "retry" : false,
  "extra" : {
    "severity" : "normal",
    "retries" : [ ],
    "categories" : [ {
      "name" : "Product defects",
      "matchedStatuses" : [ ],
      "flaky" : false
    } ],
    "tags" : [ ]
  },
  "source" : "96866712c99aa59c.json",
  "parameterValues" : [ "2 BIRCH STREET, LYTHAM ST. ANNES, LANCS, FY8 5DT", "today-3", "19/10/2026", "SDYY2-14C", "Vaccination Centre", "Flu", "yes", "17/7/1994", "yes", "11", "MARIAN PIESSE", "9450134391", "BECCLES HOUSE", "yes", "today" ]
}