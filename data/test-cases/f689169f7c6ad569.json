{
  "uid" : "f689169f7c6ad569",
  "name" : "Record a vaccine with nhs number [10-9474405174-ALBERT HOUSE-Outreach event-yes-today-2-yes-yes-today-PHINEAS FAYLE-4/9/1965-2 DIXON TERRACE, NETHER KELLET, CARNFORTH, LANCS, LA6 1EX-Flu-AUTOMATION-CBQI-19/10/2026]",
  "fullName" : "/app/features/record_a_vaccine_for_patient_with_nhs_number.feature:Record a vaccine with nhs number",
  "historyId" : "a3a4c660d017bf2fa3f72ef7fb2ce224",
  "time" : {
    "start" : 1731662932358,
    "stop" : 1731662969682,
    "duration" : 37324
  },
  "status" : "failed",
  "statusMessage" : "AssertionError: assert 20 >= (20 + 1)\n +  where 20 = int(20)\n +  and   20 = int(20)",
  "statusTrace" : "fixturefunc = <function immunisation_history_should_be_updated at 0x7f102cad8540>\nrequest = <FixtureRequest for <Function test_record_a_vaccine_with_nhs_number[10-9474405174-ALBERT HOUSE-Outreach event-yes-toda...oday-PHINEAS FAYLE-4/9/1965-2 DIXON TERRACE, NETHER KELLET, CARNFORTH, LANCS, LA6 1EX-Flu-AUTOMATION-CBQI-19/10/2026]>>\nkwargs = {'shared_data': {'assessment_comments': 'Assessment comments 13/11/2024PHINEAS FAYLE', 'batch_expiry_date': '19/10/2026', 'batch_number': 'AUTOMATION-CBQI', 'care_model': \"Housebound patient's home\", ...}}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -> FixtureValue:\n        if is_generator(fixturefunc):\n            fixturefunc = cast(\n                Callable[..., Generator[FixtureValue, None, None]], fixturefunc\n            )\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f\"{request.fixturename} did not yield a value\") from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n>           fixture_result = fixturefunc(**kwargs)\n\n.tox/py311/lib/python3.11/site-packages/_pytest/fixtures.py:898: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nshared_data = {'assessment_comments': 'Assessment comments 13/11/2024PHINEAS FAYLE', 'batch_expiry_date': '19/10/2026', 'batch_number': 'AUTOMATION-CBQI', 'care_model': \"Housebound patient's home\", ...}\n\n    @then(\"the immunisation history of the patient should be updated in the patient details page\")\n    def immunisation_history_should_be_updated(shared_data):\n        attach_screenshot(\"immunisation_history_records_count_after_vaccination\")\n        immunisation_history_records_count_after_vaccination = get_count_of_immunisation_history_records(shared_data[\"chosen_vaccine\"])\n>       assert int(immunisation_history_records_count_after_vaccination) >= int(shared_data[\"immunisation_history_records_count_before_vaccination\"]) + 1\nE       assert 20 >= (20 + 1)\nE        +  where 20 = int(20)\nE        +  and   20 = int(20)\n\ntests/test_record_a_vaccine_for_patient_with_nhs_number_steps.py:171: AssertionError",
  "flaky" : false,
  "newFailed" : false,
  "newBroken" : false,
  "newPassed" : false,
  "retriesCount" : 0,
  "retriesStatusChange" : false,
  "beforeStages" : [ ],
  "testStage" : {
    "status" : "failed",
    "statusMessage" : "AssertionError: assert 20 >= (20 + 1)\n +  where 20 = int(20)\n +  and   20 = int(20)",
    "statusTrace" : "fixturefunc = <function immunisation_history_should_be_updated at 0x7f102cad8540>\nrequest = <FixtureRequest for <Function test_record_a_vaccine_with_nhs_number[10-9474405174-ALBERT HOUSE-Outreach event-yes-toda...oday-PHINEAS FAYLE-4/9/1965-2 DIXON TERRACE, NETHER KELLET, CARNFORTH, LANCS, LA6 1EX-Flu-AUTOMATION-CBQI-19/10/2026]>>\nkwargs = {'shared_data': {'assessment_comments': 'Assessment comments 13/11/2024PHINEAS FAYLE', 'batch_expiry_date': '19/10/2026', 'batch_number': 'AUTOMATION-CBQI', 'care_model': \"Housebound patient's home\", ...}}\n\n    def call_fixture_func(\n        fixturefunc: _FixtureFunc[FixtureValue], request: FixtureRequest, kwargs\n    ) -> FixtureValue:\n        if is_generator(fixturefunc):\n            fixturefunc = cast(\n                Callable[..., Generator[FixtureValue, None, None]], fixturefunc\n            )\n            generator = fixturefunc(**kwargs)\n            try:\n                fixture_result = next(generator)\n            except StopIteration:\n                raise ValueError(f\"{request.fixturename} did not yield a value\") from None\n            finalizer = functools.partial(_teardown_yield_fixture, fixturefunc, generator)\n            request.addfinalizer(finalizer)\n        else:\n            fixturefunc = cast(Callable[..., FixtureValue], fixturefunc)\n>           fixture_result = fixturefunc(**kwargs)\n\n.tox/py311/lib/python3.11/site-packages/_pytest/fixtures.py:898: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nshared_data = {'assessment_comments': 'Assessment comments 13/11/2024PHINEAS FAYLE', 'batch_expiry_date': '19/10/2026', 'batch_number': 'AUTOMATION-CBQI', 'care_model': \"Housebound patient's home\", ...}\n\n    @then(\"the immunisation history of the patient should be updated in the patient details page\")\n    def immunisation_history_should_be_updated(shared_data):\n        attach_screenshot(\"immunisation_history_records_count_after_vaccination\")\n        immunisation_history_records_count_after_vaccination = get_count_of_immunisation_history_records(shared_data[\"chosen_vaccine\"])\n>       assert int(immunisation_history_records_count_after_vaccination) >= int(shared_data[\"immunisation_history_records_count_before_vaccination\"]) + 1\nE       assert 20 >= (20 + 1)\nE        +  where 20 = int(20)\nE        +  and   20 = int(20)\n\ntests/test_record_a_vaccine_for_patient_with_nhs_number_steps.py:171: AssertionError",
    "steps" : [ {
      "name" : "Given I login to RAVS and set vaccinator details with ALBERT HOUSE and Outreach event and get patient details for 9474405174 with option 10 and choose to vaccinate with vaccine details as Flu, AUTOMATION-CBQI with 19/10/2026",
      "time" : {
        "start" : 1731662932359,
        "stop" : 1731662936006,
        "duration" : 3647
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 0,
      "shouldDisplayMessage" : false,
      "hasContent" : false
    }, {
      "name" : "And I search for a patient with the NHS number in the find a patient screen",
      "time" : {
        "start" : 1731662936006,
        "stop" : 1731662941296,
        "duration" : 5290
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "31d57105014afac8",
        "name" : "qa_edge_131.0.2903.48_entered_nhs_number_as9474405174_and_clicked_search_for_patient_button.png",
        "source" : "31d57105014afac8.png",
        "type" : "image/png",
        "size" : 48605
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 1,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I open the patient record by clicking on patient PHINEAS FAYLE",
      "time" : {
        "start" : 1731662941296,
        "stop" : 1731662942579,
        "duration" : 1283
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "bc99eea5d245a5f",
        "name" : "qa_edge_131.0.2903.48_before_clicking_patient_name.png",
        "source" : "bc99eea5d245a5f.png",
        "type" : "image/png",
        "size" : 48605
      }, {
        "uid" : "fbbbffeee506d7cd",
        "name" : "qa_edge_131.0.2903.48_before_clicking_patient_name.png",
        "source" : "fbbbffeee506d7cd.png",
        "type" : "image/png",
        "size" : 47792
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 2,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "When I click choose vaccine button and choose the Flu, AUTOMATION-CBQI with 19/10/2026 and click continue",
      "time" : {
        "start" : 1731662942579,
        "stop" : 1731662950496,
        "duration" : 7917
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "75b88c99854f0e38",
        "name" : "qa_edge_131.0.2903.48_clicked_on_patient_PHINEAS FAYLE_and_clicked_choose_vaccine_button.png",
        "source" : "75b88c99854f0e38.png",
        "type" : "image/png",
        "size" : 50824
      }, {
        "uid" : "f477050f48a0dee",
        "name" : "qa_edge_131.0.2903.48_selected_vaccine_Flu_and_Cell-based Quadrivalent Influenza Vaccine_and_clicked_continue_button.png",
        "source" : "f477050f48a0dee.png",
        "type" : "image/png",
        "size" : 74467
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 2,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I assess the patient's yes with the details and date as today-2 and click continue to record consent screen button",
      "time" : {
        "start" : 1731662950496,
        "stop" : 1731662952430,
        "duration" : 1934
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "4d7785fac3afdc85",
        "name" : "qa_edge_131.0.2903.48_clicked_eligibility_yes_and_selected_eligibility_type.png",
        "source" : "4d7785fac3afdc85.png",
        "type" : "image/png",
        "size" : 76500
      }, {
        "uid" : "514b9525e8b46364",
        "name" : "qa_edge_131.0.2903.48_clicked_patient_give_vaccine_radio_button.png",
        "source" : "514b9525e8b46364.png",
        "type" : "image/png",
        "size" : 78164
      }, {
        "uid" : "6e25da9347293d38",
        "name" : "qa_edge_131.0.2903.48_clicked_continue_to_record_consent_button.png",
        "source" : "6e25da9347293d38.png",
        "type" : "image/png",
        "size" : 43651
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 3,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I record yes with the details and click continue to vaccinate button",
      "time" : {
        "start" : 1731662952431,
        "stop" : 1731662954148,
        "duration" : 1717
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "5f69300ff5982f85",
        "name" : "qa_edge_131.0.2903.48_before_selecting_consent_clinician.png",
        "source" : "5f69300ff5982f85.png",
        "type" : "image/png",
        "size" : 43651
      }, {
        "uid" : "806e258e78e5db02",
        "name" : "qa_edge_131.0.2903.48_clicked_continue_to_vaccinate_button.png",
        "source" : "806e258e78e5db02.png",
        "type" : "image/png",
        "size" : 61208
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 2,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I record yes details and date as today and click Continue to Check and confirm screen",
      "time" : {
        "start" : 1731662954149,
        "stop" : 1731662958532,
        "duration" : 4383
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "1c279a8e6c1e63dc",
        "name" : "qa_edge_131.0.2903.48_entered_vaccination_details.png",
        "source" : "1c279a8e6c1e63dc.png",
        "type" : "image/png",
        "size" : 63176
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 1,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "Then I need to be able to see the patient PHINEAS FAYLE, 4/9/1965, 2 DIXON TERRACE, NETHER KELLET, CARNFORTH, LANCS, LA6 1EX and vaccination details on the check and confirm screen",
      "time" : {
        "start" : 1731662958532,
        "stop" : 1731662959262,
        "duration" : 730
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "8a05d468dae28df8",
        "name" : "qa_edge_131.0.2903.48_check_and_confirm_screen_before_assertion.png",
        "source" : "8a05d468dae28df8.png",
        "type" : "image/png",
        "size" : 63248
      }, {
        "uid" : "3f608333b6fb0359",
        "name" : "qa_edge_131.0.2903.48_vaccination_dose_amount.png",
        "source" : "3f608333b6fb0359.png",
        "type" : "image/png",
        "size" : 63248
      }, {
        "uid" : "f0911bc1f89893c",
        "name" : "qa_edge_131.0.2903.48_check_and_confirm_screen_after_assertion.png",
        "source" : "f0911bc1f89893c.png",
        "type" : "image/png",
        "size" : 63248
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 3,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And when I click confirm and save button, I should see a record saved dialogue",
      "time" : {
        "start" : 1731662959262,
        "stop" : 1731662960018,
        "duration" : 756
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "926210b666fa9480",
        "name" : "qa_edge_131.0.2903.48_patient_details_screen_with_immunisation_history.png",
        "source" : "926210b666fa9480.png",
        "type" : "image/png",
        "size" : 63248
      }, {
        "uid" : "6cfb14fbdb69cd30",
        "name" : "qa_edge_131.0.2903.48_before_assert_record_saved.png",
        "source" : "6cfb14fbdb69cd30.png",
        "type" : "image/png",
        "size" : 34843
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 2,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I search for a patient with the NHS number in the find a patient screen",
      "time" : {
        "start" : 1731662960018,
        "stop" : 1731662965265,
        "duration" : 5247
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "e3c9ed3e6fb1e0c8",
        "name" : "qa_edge_131.0.2903.48_entered_nhs_number_as9474405174_and_clicked_search_for_patient_button.png",
        "source" : "e3c9ed3e6fb1e0c8.png",
        "type" : "image/png",
        "size" : 47303
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 1,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And I open the patient record by clicking on patient PHINEAS FAYLE",
      "time" : {
        "start" : 1731662965266,
        "stop" : 1731662966544,
        "duration" : 1278
      },
      "status" : "passed",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "9381f3025e8a5b9a",
        "name" : "qa_edge_131.0.2903.48_before_clicking_patient_name.png",
        "source" : "9381f3025e8a5b9a.png",
        "type" : "image/png",
        "size" : 47303
      }, {
        "uid" : "51a9c5f0d219fe33",
        "name" : "qa_edge_131.0.2903.48_before_clicking_patient_name.png",
        "source" : "51a9c5f0d219fe33.png",
        "type" : "image/png",
        "size" : 47792
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 2,
      "shouldDisplayMessage" : false,
      "hasContent" : true
    }, {
      "name" : "And the immunisation history of the patient should be updated in the patient details page",
      "time" : {
        "start" : 1731662966544,
        "stop" : 1731662969682,
        "duration" : 3138
      },
      "status" : "failed",
      "statusMessage" : "assert 20 >= (20 + 1)\n +  where 20 = int(20)\n +  and   20 = int(20)",
      "statusTrace" : "AssertionError: assert 20 >= (20 + 1)\n +  where 20 = int(20)\n +  and   20 = int(20)\n",
      "steps" : [ ],
      "attachments" : [ {
        "uid" : "1d29f062ef3fcc15",
        "name" : "qa_edge_131.0.2903.48_immunisation_history_records_count_after_vaccination.png",
        "source" : "1d29f062ef3fcc15.png",
        "type" : "image/png",
        "size" : 47792
      } ],
      "parameters" : [ ],
      "stepsCount" : 0,
      "attachmentsCount" : 1,
      "shouldDisplayMessage" : true,
      "hasContent" : true
    } ],
    "attachments" : [ {
      "uid" : "14b7d56228d0a21c",
      "name" : "log",
      "source" : "14b7d56228d0a21c.txt",
      "type" : "text/plain",
      "size" : 16614
    } ],
    "parameters" : [ ],
    "stepsCount" : 12,
    "attachmentsCount" : 21,
    "shouldDisplayMessage" : true,
    "hasContent" : true
  },
  "afterStages" : [ ],
  "labels" : [ {
    "name" : "host",
    "value" : "7853cb8746b6"
  }, {
    "name" : "thread",
    "value" : "1102-MainThread"
  }, {
    "name" : "framework",
    "value" : "pytest-bdd"
  }, {
    "name" : "language",
    "value" : "cpython3"
  }, {
    "name" : "feature",
    "value" : "Record vaccine"
  }, {
    "name" : "resultFormat",
    "value" : "allure2"
  } ],
  "parameters" : [ {
    "name" : "address",
    "value" : "2 DIXON TERRACE, NETHER KELLET, CARNFORTH, LANCS, LA6 1EX"
  }, {
    "name" : "assess_date",
    "value" : "today-2"
  }, {
    "name" : "batch_expiry_date",
    "value" : "19/10/2026"
  }, {
    "name" : "batch_number",
    "value" : "AUTOMATION-CBQI"
  }, {
    "name" : "care_model",
    "value" : "Outreach event"
  }, {
    "name" : "chosen_vaccine",
    "value" : "Flu"
  }, {
    "name" : "consent",
    "value" : "yes"
  }, {
    "name" : "dob",
    "value" : "4/9/1965"
  }, {
    "name" : "eligibility",
    "value" : "yes"
  }, {
    "name" : "index",
    "value" : "10"
  }, {
    "name" : "name",
    "value" : "PHINEAS FAYLE"
  }, {
    "name" : "nhs_number",
    "value" : "9474405174"
  }, {
    "name" : "site",
    "value" : "ALBERT HOUSE"
  }, {
    "name" : "vaccination",
    "value" : "yes"
  }, {
    "name" : "vaccination_date",
    "value" : "today"
  } ],
  "links" : [ ],
  "hidden" : false,
  "retry" : false,
  "extra" : {
    "severity" : "normal",
    "retries" : [ ],
    "categories" : [ {
      "name" : "Product defects",
      "matchedStatuses" : [ ],
      "flaky" : false
    } ],
    "tags" : [ ]
  },
  "source" : "f689169f7c6ad569.json",
  "parameterValues" : [ "2 DIXON TERRACE, NETHER KELLET, CARNFORTH, LANCS, LA6 1EX", "today-2", "19/10/2026", "AUTOMATION-CBQI", "Outreach event", "Flu", "yes", "4/9/1965", "yes", "10", "PHINEAS FAYLE", "9474405174", "ALBERT HOUSE", "yes", "today" ]
}